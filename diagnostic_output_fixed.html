   
Warning: Cannot modify header information - headers already sent by (output started at /var/www/html/core/config_manager.php:331) in /var/www/diagnose_discount_purchases.php on line 12
<h1>🔍 Discount Purchase Diagnostic</h1><p>Checking the status of recent discount purchases...</p><h2>📊 Recent Business Purchases</h2><table border='1' style='border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;'><tr style='background: #f0f0f0;'><th style='padding: 8px;'>ID</th><th style='padding: 8px;'>User</th><th style='padding: 8px;'>Item</th><th style='padding: 8px;'>Business</th><th style='padding: 8px;'>DB Status</th><th style='padding: 8px;'>Computed Status</th><th style='padding: 8px;'>Has QR Code</th><th style='padding: 8px;'>Days Until Expiry</th><th style='padding: 8px;'>Scan Count</th><th style='padding: 8px;'>Created</th></tr><tr><td style='padding: 8px;'>38</td><td style='padding: 8px;'>Bob</td><td style='padding: 8px;'>7-Eleven Sparkling Water (Lime)</td><td style='padding: 8px;'>Shared Value Vending</td><td style='padding: 8px;'>pending</td><td style='padding: 8px; background: #28a745; color: white; font-weight: bold;'>ACTIVE</td><td style='padding: 8px;'>✅ Yes</td><td style='padding: 8px;'>29 days</td><td style='padding: 8px;'>0</td><td style='padding: 8px;'>Jun 21, 2025 11:08</td></tr><tr><td style='padding: 8px;'>34</td><td style='padding: 8px;'>Bob</td><td style='padding: 8px;'>5% Discount - Mike</td><td style='padding: 8px;'>Mike</td><td style='padding: 8px;'>pending</td><td style='padding: 8px; background: #28a745; color: white; font-weight: bold;'>ACTIVE</td><td style='padding: 8px;'>✅ Yes</td><td style='padding: 8px;'>29 days</td><td style='padding: 8px;'>0</td><td style='padding: 8px;'>Jun 21, 2025 10:26</td></tr><tr><td style='padding: 8px;'>32</td><td style='padding: 8px;'>sharedvaluevending</td><td style='padding: 8px;'>5% Discount - Mike</td><td style='padding: 8px;'>Mike</td><td style='padding: 8px;'>pending</td><td style='padding: 8px; background: #28a745; color: white; font-weight: bold;'>ACTIVE</td><td style='padding: 8px;'>✅ Yes</td><td style='padding: 8px;'>29 days</td><td style='padding: 8px;'>0</td><td style='padding: 8px;'>Jun 21, 2025 08:14</td></tr><tr><td style='padding: 8px;'>24</td><td style='padding: 8px;'>Bob</td><td style='padding: 8px;'>Lay's Chips</td><td style='padding: 8px;'>Shared Value Vending</td><td style='padding: 8px;'>pending</td><td style='padding: 8px; background: #28a745; color: white; font-weight: bold;'>ACTIVE</td><td style='padding: 8px;'>✅ Yes</td><td style='padding: 8px;'>28 days</td><td style='padding: 8px;'>0</td><td style='padding: 8px;'>Jun 19, 2025 19:03</td></tr><tr><td style='padding: 8px;'>23</td><td style='padding: 8px;'>Bob</td><td style='padding: 8px;'>Lay's Chips</td><td style='padding: 8px;'>Shared Value Vending</td><td style='padding: 8px;'>pending</td><td style='padding: 8px; background: #28a745; color: white; font-weight: bold;'>ACTIVE</td><td style='padding: 8px;'>✅ Yes</td><td style='padding: 8px;'>28 days</td><td style='padding: 8px;'>0</td><td style='padding: 8px;'>Jun 19, 2025 19:02</td></tr><tr><td style='padding: 8px;'>22</td><td style='padding: 8px;'>Bob</td><td style='padding: 8px;'>Lay's Chips</td><td style='padding: 8px;'>Shared Value Vending</td><td style='padding: 8px;'>pending</td><td style='padding: 8px; background: #28a745; color: white; font-weight: bold;'>ACTIVE</td><td style='padding: 8px;'>✅ Yes</td><td style='padding: 8px;'>28 days</td><td style='padding: 8px;'>0</td><td style='padding: 8px;'>Jun 19, 2025 19:02</td></tr><tr><td style='padding: 8px;'>21</td><td style='padding: 8px;'>Bob</td><td style='padding: 8px;'>Lay's Chips</td><td style='padding: 8px;'>Shared Value Vending</td><td style='padding: 8px;'>pending</td><td style='padding: 8px; background: #28a745; color: white; font-weight: bold;'>ACTIVE</td><td style='padding: 8px;'>✅ Yes</td><td style='padding: 8px;'>28 days</td><td style='padding: 8px;'>0</td><td style='padding: 8px;'>Jun 19, 2025 17:57</td></tr><tr><td style='padding: 8px;'>20</td><td style='padding: 8px;'>Bob</td><td style='padding: 8px;'>Lay's Chips</td><td style='padding: 8px;'>Shared Value Vending</td><td style='padding: 8px;'>pending</td><td style='padding: 8px; background: #28a745; color: white; font-weight: bold;'>ACTIVE</td><td style='padding: 8px;'>✅ Yes</td><td style='padding: 8px;'>28 days</td><td style='padding: 8px;'>0</td><td style='padding: 8px;'>Jun 19, 2025 17:53</td></tr><tr><td style='padding: 8px;'>19</td><td style='padding: 8px;'>Bob</td><td style='padding: 8px;'>Lay's Chips</td><td style='padding: 8px;'>Shared Value Vending</td><td style='padding: 8px;'>pending</td><td style='padding: 8px; background: #28a745; color: white; font-weight: bold;'>ACTIVE</td><td style='padding: 8px;'>✅ Yes</td><td style='padding: 8px;'>28 days</td><td style='padding: 8px;'>0</td><td style='padding: 8px;'>Jun 19, 2025 17:53</td></tr><tr><td style='padding: 8px;'>18</td><td style='padding: 8px;'>Bob</td><td style='padding: 8px;'>Lay's Chips</td><td style='padding: 8px;'>Shared Value Vending</td><td style='padding: 8px;'>pending</td><td style='padding: 8px; background: #28a745; color: white; font-weight: bold;'>ACTIVE</td><td style='padding: 8px;'>✅ Yes</td><td style='padding: 8px;'>28 days</td><td style='padding: 8px;'>0</td><td style='padding: 8px;'>Jun 19, 2025 17:53</td></tr></table><hr><h2>💰 User QR Coin Balances</h2><table border='1' style='border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;'><tr style='background: #f0f0f0;'><th style='padding: 8px;'>User ID</th><th style='padding: 8px;'>Username</th><th style='padding: 8px;'>QR Coin Balance</th><th style='padding: 8px;'>Discount Purchases</th></tr><tr><td style='padding: 8px;'>1</td><td style='padding: 8px;'>sharedvaluevending</td><td style='padding: 8px;'>182</td><td style='padding: 8px;'>0</td></tr><tr><td style='padding: 8px;'>2</td><td style='padding: 8px;'>Mike</td><td style='padding: 8px;'>1115</td><td style='padding: 8px;'>0</td></tr><tr><td style='padding: 8px;'>4</td><td style='padding: 8px;'>Dax is the 🐐</td><td style='padding: 8px;'>1000</td><td style='padding: 8px;'>0</td></tr><tr><td style='padding: 8px;'>5</td><td style='padding: 8px;'>Bob</td><td style='padding: 8px;'>156</td><td style='padding: 8px;'>0</td></tr></table><hr><h2>🔍 QR Code Validation Test</h2><h4>Testing Purchase ID: 1</h4><p><strong>Purchase Code:</strong> 75E49BDC</p><p>✅ <strong>QR Code Validation: PASSED</strong></p><p>Business: Shared Value Vending</p><p>Discount: 12.00%</p><hr><h4>Testing Purchase ID: 2</h4><p><strong>Purchase Code:</strong> C8396429</p><p>✅ <strong>QR Code Validation: PASSED</strong></p><p>Business: Shared Value Vending</p><p>Discount: 20.00%</p><hr><h4>Testing Purchase ID: 3</h4><p><strong>Purchase Code:</strong> B98500A1</p><p>✅ <strong>QR Code Validation: PASSED</strong></p><p>Business: Shared Value Vending</p><p>Discount: 20.00%</p><hr><h2>📋 Summary & Recommendations</h2><ul><li><strong>Active Purchases:</strong> 10</li><li><strong>Inactive/Expired Purchases:</strong> 0</li><li><strong>Purchases Missing QR Codes:</strong> 0</li></ul><div style='background: #d4edda; border: 1px solid #c3e6cb; padding: 15px; border-radius: 5px;'><h4>✅ Good News: Active Purchases Found</h4><p>There are 10 active purchases. If users are seeing 'inactive transactions', the issue might be in the user interface display logic.</p></div><hr><p><strong>Next Steps:</strong></p><ol><li>If purchases show as ACTIVE here but appear inactive to users, check the UI display logic</li><li>If QR codes are missing, check the QR code generation process</li><li>If all purchases are expired, users need to make new purchases</li><li>Test the actual QR code scanning process at a vending machine</li></ol><p><a href='html/user/my-discount-qr-codes.php'>👀 View User's Discount Codes Page</a> | <a href='html/nayax/discount-store.php'>🛒 Visit Discount Store</a></p> 